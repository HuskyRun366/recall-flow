<div class="lernen-home-container" appPullToRefresh (refresh)="refreshData()">
  <!-- Header -->
  <div class="home-header">
    <h1>{{ 'lernen.myFlashcards' | translate }}</h1>
    <p class="subtitle">{{ 'lernen.welcomeBack' | translate }}</p>
  </div>

  @if (isLoading()) {
    <div class="skeleton-grid">
      @for (item of [1,2,3,4,5,6]; track item) {
        <app-skeleton-loader type="card" />
      }
    </div>
  } @else if (error()) {
    <div class="error-state">
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="8" x2="12" y2="12"/>
        <line x1="12" y1="16" x2="12.01" y2="16"/>
      </svg>
      <h2>{{ 'errors.loadingFailed' | translate }}</h2>
      <p>{{ error() | translate }}</p>
      <button class="btn btn-primary" (click)="refreshData()">{{ 'common.retry' | translate }}</button>
    </div>
  } @else {
    <!-- Statistics Summary -->
    <div class="stats-summary">
      <app-stat-card [config]="{
        icon: 'svg',
        iconContent: '<rect x=\'2\' y=\'7\' width=\'20\' height=\'14\' rx=\'2\'/><path d=\'M2 11h20\'/>',
        value: totalDecks(),
        label: ('flashcard.decks' | translate)
      }" />

      <app-stat-card [config]="{
        icon: 'svg',
        iconContent: '<path d=\'M9 11H3v9h6v-9Z M21 11h-6v9h6v-9Z M15 5H9v14h6V5Z\'/>',
        value: totalFlashcards(),
        label: ('nav.flashcards' | translate)
      }" />

      <app-stat-card [config]="{
        icon: 'svg',
        iconContent: '<polyline points=\'22 12 18 12 15 21 9 3 6 12 2 12\'/>',
        value: overallProgress() + '%',
        label: ('stats.progress' | translate)
      }" />
    </div>

    <!-- Progress Bars -->
    @if (totalFlashcards() > 0) {
      <div class="card progress-card">
        <h2>{{ 'lernen.learningProgress' | translate }}</h2>
        <app-progress-bar [config]="progressBarConfig()" />
      </div>
    }

    <!-- Quick Actions -->
    <div class="quick-actions">
      <a routerLink="/lernen/decks" class="action-card">
        <div class="action-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="7" width="20" height="14" rx="2"/>
            <path d="M2 11h20"/>
          </svg>
        </div>
        <div class="action-content">
          <h3>{{ 'lernen.flashcardDecks' | translate }}</h3>
          <p>{{ 'lernen.manageDecks' | translate }}</p>
        </div>
        <svg class="action-arrow" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </a>

      <a routerLink="/lernen/materials" class="action-card">
        <div class="action-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
          </svg>
        </div>
        <div class="action-content">
          <h3>{{ 'lernen.learningMaterials' | translate }}</h3>
          <p>{{ 'lernen.viewMaterials' | translate }}</p>
        </div>
        <svg class="action-arrow" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </a>
    </div>

    <!-- Recent Decks -->
    @if (recentDecks().length > 0) {
      <div class="card recent-card">
        <div class="card-header">
          <h2>{{ 'lernen.recentlyEdited' | translate }}</h2>
          <a [routerLink]="['/lernen/decks']" class="view-all">{{ 'common.viewAll' | translate }}</a>
        </div>
        <div class="deck-list">
          @for (item of recentDecks(); track item.deck.id) {
            <div class="deck-card" [routerLink]="['/lernen/deck-editor', item.deck.id]">
              <div class="deck-header">
                <div class="deck-avatar">
                  {{ item.deck.title.charAt(0).toUpperCase() }}
                </div>
                <div class="deck-info">
                  <h3>{{ item.deck.title }}</h3>
                  @if (item.deck.description) {
                    <p class="deck-description">{{ item.deck.description }}</p>
                  }
                  <div class="deck-meta">
                    <span class="meta-item">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="7" width="20" height="14" rx="2"/>
                        <path d="M2 11h20"/>
                      </svg>
                      {{ item.totalCards }} {{ 'common.cards' | translate }}
                    </span>
                    <span class="meta-item">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v6l4 2"/>
                      </svg>
                      {{ item.deck.updatedAt | date:'short' }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    }

    <!-- Empty State -->
    @if (decksWithProgress().length === 0) {
      <div class="empty-state">
        <svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <rect x="2" y="7" width="20" height="14" rx="2"/>
          <path d="M2 11h20"/>
        </svg>
        <h2>{{ 'lernen.noDecksFound' | translate }}</h2>
        <p>{{ 'lernen.createFirstDeck' | translate }}</p>
        <a routerLink="/lernen/deck-editor/new" class="btn btn-primary">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
          {{ 'lernen.newDeck' | translate }}
        </a>
      </div>
    }
  }
</div>

<!-- FAB (Floating Action Button) -->
@if (!isLoading() && !error()) {
  <div class="fab-container" [class.open]="fabOpen()">
    <div class="fab-menu">
      <a class="fab-item" routerLink="/lernen/deck-editor/new" (click)="toggleFab()">
        <span class="icon-circle">âž•</span>
        <span class="label">{{ 'lernen.newDeck' | translate }}</span>
      </a>
      <a class="fab-item" routerLink="/lernen/material-editor/new" (click)="toggleFab()">
        <span class="icon-circle">ðŸ“„</span>
        <span class="label">{{ 'lernen.newMaterial' | translate }}</span>
      </a>
    </div>

    <button type="button"
            class="fab"
            (click)="toggleFab()"
            [attr.aria-expanded]="fabOpen()"
            [attr.aria-label]="'lernen.openCreateMenu' | translate"
            aria-haspopup="menu">
      <span class="fab-lines" aria-hidden="true"></span>
    </button>
  </div>
}
