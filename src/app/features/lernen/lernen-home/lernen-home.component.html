<div class="lernen-home-container" appPullToRefresh (refresh)="refreshData()">
  <!-- Header -->
  <div class="home-header">
    <h1>Meine Lernkarten</h1>
    <p class="subtitle">Willkommen zur√ºck! Bereit zum Lernen?</p>
  </div>

  @if (isLoading()) {
    <div class="skeleton-grid">
      @for (item of [1,2,3,4,5,6]; track item) {
        <app-skeleton-loader type="card" />
      }
    </div>
  } @else if (error()) {
    <div class="error-state">
      <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="10"/>
        <line x1="12" y1="8" x2="12" y2="12"/>
        <line x1="12" y1="16" x2="12.01" y2="16"/>
      </svg>
      <h2>Fehler beim Laden</h2>
      <p>{{ error() }}</p>
      <button class="btn btn-primary" (click)="refreshData()">Erneut versuchen</button>
    </div>
  } @else {
    <!-- Statistics Summary -->
    <div class="stats-summary">
      <app-stat-card [config]="totalDecksConfig()" />
      <app-stat-card [config]="totalCardsConfig()" />
      <app-stat-card [config]="progressConfig()" />
    </div>

    <!-- Progress Bars -->
    @if (totalFlashcards() > 0) {
      <div class="card progress-card">
        <h2>Lernfortschritt</h2>
        <app-progress-bar [config]="progressBarConfig()" />
      </div>
    }

    <!-- Quick Actions -->
    <div class="quick-actions">
      <a routerLink="/lernen/decks" class="action-card">
        <div class="action-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <rect x="2" y="7" width="20" height="14" rx="2"/>
            <path d="M2 11h20"/>
          </svg>
        </div>
        <div class="action-content">
          <h3>Flashcard Decks</h3>
          <p>Lernkarten erstellen und verwalten</p>
        </div>
        <svg class="action-arrow" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </a>

      <a routerLink="/lernen/materials" class="action-card">
        <div class="action-icon">
          <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
            <polyline points="14 2 14 8 20 8"/>
          </svg>
        </div>
        <div class="action-content">
          <h3>Lernunterlagen</h3>
          <p>Interaktive HTML-Dokumente anzeigen</p>
        </div>
        <svg class="action-arrow" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <polyline points="9 18 15 12 9 6"/>
        </svg>
      </a>
    </div>

    <!-- Recent Decks -->
    @if (recentDecks().length > 0) {
      <div class="card recent-card">
        <div class="card-header">
          <h2>Zuletzt bearbeitet</h2>
          <a [routerLink]="['/lernen/decks']" class="view-all">Alle anzeigen</a>
        </div>
        <div class="deck-list">
          @for (item of recentDecks(); track item.deck.id) {
            <div class="deck-card" [routerLink]="['/lernen/deck-editor', item.deck.id]">
              <div class="deck-header">
                <div class="deck-avatar">
                  {{ item.deck.title.charAt(0).toUpperCase() }}
                </div>
                <div class="deck-info">
                  <h3>{{ item.deck.title }}</h3>
                  @if (item.deck.description) {
                    <p class="deck-description">{{ item.deck.description }}</p>
                  }
                  <div class="deck-meta">
                    <span class="meta-item">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="7" width="20" height="14" rx="2"/>
                        <path d="M2 11h20"/>
                      </svg>
                      {{ item.totalCards }} Karten
                    </span>
                    <span class="meta-item">
                      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M12 6v6l4 2"/>
                      </svg>
                      {{ item.deck.updatedAt | date:'short' }}
                    </span>
                  </div>
                </div>
              </div>
            </div>
          }
        </div>
      </div>
    }

    <!-- Empty State -->
    @if (decksWithProgress().length === 0) {
      <div class="empty-state">
        <svg width="120" height="120" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5">
          <rect x="2" y="7" width="20" height="14" rx="2"/>
          <path d="M2 11h20"/>
        </svg>
        <h2>Keine Decks gefunden</h2>
        <p>Erstelle dein erstes Lernkarten-Deck und beginne zu lernen</p>
        <a routerLink="/lernen/deck-editor/new" class="btn btn-primary">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
          </svg>
          Neues Deck erstellen
        </a>
      </div>
    }
  }
</div>

<!-- FAB (Floating Action Button) -->
@if (!isLoading() && !error()) {
  <a routerLink="/lernen/deck-editor/new" class="fab" aria-label="Neues Deck erstellen">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <line x1="12" y1="5" x2="12" y2="19"/>
      <line x1="5" y1="12" x2="19" y2="12"/>
    </svg>
  </a>
}
