<div class="ordering-question">
  <div class="question-text">
    <h3>{{ question.questionText }}</h3>
    <p class="instruction">{{ 'quizSession.ordering.instruction' | translate }}</p>
  </div>

  <div class="question-image" *ngIf="question.imageUrl">
    <img [src]="question.imageUrl" [alt]="question.questionText">
  </div>

  <div
    class="order-list"
    cdkDropList
    (cdkDropListDropped)="drop($event)">
    <div
      *ngFor="let item of currentOrder(); let i = index"
      class="order-item"
      [class]="getItemClass(item, i)"
      cdkDrag
      [cdkDragDisabled]="disabled || submitted()">
      <div class="drag-handle">
        <svg width="16" height="16" viewBox="0 0 16 16">
          <circle cx="4" cy="4" r="1.5" fill="currentColor"/>
          <circle cx="12" cy="4" r="1.5" fill="currentColor"/>
          <circle cx="4" cy="8" r="1.5" fill="currentColor"/>
          <circle cx="12" cy="8" r="1.5" fill="currentColor"/>
          <circle cx="4" cy="12" r="1.5" fill="currentColor"/>
          <circle cx="12" cy="12" r="1.5" fill="currentColor"/>
        </svg>
      </div>
      <span class="item-number">{{ i + 1 }}</span>
      <span class="item-text">{{ item.text }}</span>
      <span class="item-indicator" *ngIf="showResult">
        <span *ngIf="item.correctOrder === i">✓</span>
        <span *ngIf="item.correctOrder !== i">✗</span>
      </span>
    </div>
  </div>

  <div class="submit-area" *ngIf="!submitted()">
    <button class="btn btn-primary" (click)="submitAnswer()">
      {{ 'quizSession.actions.submitAnswer' | translate }}
    </button>
  </div>

  <div class="result-message" *ngIf="showResult">
    <div class="message" [class.correct]="isCorrect()" [class.incorrect]="!isCorrect()">
      <strong>{{ isCorrect() ? ('quizSession.ordering.perfect' | translate) : ('quizSession.ordering.notQuite' | translate) }}</strong>
      <span *ngIf="!isCorrect()">{{ 'quizSession.ordering.reviewCorrectOrder' | translate }}</span>
    </div>

    <div class="correct-order" *ngIf="!isCorrect()">
      <p class="label">{{ 'quizSession.ordering.correctOrder' | translate }}</p>
      <div class="pill" *ngFor="let item of correctOrder(); let idx = index">
        <span class="badge">{{ idx + 1 }}</span>
        <span class="text">{{ item.text }}</span>
      </div>
    </div>
  </div>
</div>
