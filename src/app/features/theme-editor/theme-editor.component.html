<div class="theme-editor">
  <div class="editor-header">
    <div class="header-left">
      <p class="eyebrow">
        {{ 'discover.contentTypes.theme' | translate }}
        @if (unsavedChanges()) {
          <span> â€¢ {{ 'common.unsaved' | translate }}</span>
        }
      </p>

      <h1>
        @if (mode() === 'new') {
          {{ 'common.create' | translate }} {{ 'discover.contentTypes.theme' | translate }}
        } @else {
          {{ title() || ('discover.contentTypes.theme' | translate) }}
        }
      </h1>

      <p class="subtitle">{{ 'settings.page.theme.subtitle' | translate }}</p>
    </div>

    <div class="header-right">
      @if (mode() === 'edit') {
        <button class="btn btn-secondary" type="button" (click)="delete()" [disabled]="isLoading() || isSaving()">
          {{ 'common.delete' | translate }}
        </button>
      }

      <button class="btn btn-primary" type="button" (click)="save()" [disabled]="isLoading() || isSaving() || !unsavedChanges()">
        {{ isSaving() ? ('common.saving' | translate) : ('common.save' | translate) }}
      </button>

      <button class="btn btn-secondary" type="button" (click)="cancel()" [disabled]="isSaving()">
        {{ 'common.cancel' | translate }}
      </button>
    </div>
  </div>

  @if (error()) {
    <div class="error-state">
      <h2>{{ 'errors.loadingFailed' | translate }}</h2>
      <p>{{ error() }}</p>
      <button class="btn btn-secondary" type="button" (click)="cancel()">
        {{ 'common.back' | translate }}
      </button>
    </div>
  }

  @if (isLoading()) {
    <div class="loading-container">
      <div class="spinner"></div>
      <p>{{ 'discover.loading' | translate }}</p>
    </div>
  } @else if (!error()) {
    <div class="editor-content">
      <div class="form-card">
        <div class="row">
          <label for="themeTitle">{{ 'common.title' | translate }}</label>
          <input
            id="themeTitle"
            type="text"
            autocomplete="off"
            [ngModel]="title()"
            (ngModelChange)="title.set($event)"
            [placeholder]="'settings.page.theme.custom.namePlaceholder' | translate" />
        </div>

        <div class="row">
          <label for="themeDescription">{{ 'common.description' | translate }}</label>
          <textarea
            id="themeDescription"
            rows="3"
            [ngModel]="description()"
            (ngModelChange)="description.set($event)"
            [placeholder]="'common.descriptionPlaceholder' | translate"></textarea>
        </div>

        <div class="row">
          <label>{{ 'common.visibility' | translate }}</label>
          <div class="visibility-toggle">
            <label class="toggle-option">
              <input
                type="radio"
                name="visibility"
                value="private"
                [ngModel]="visibility()"
                (ngModelChange)="visibility.set($event)" />
              <span>{{ 'quiz.visibility.private' | translate }}</span>
            </label>
            <label class="toggle-option">
              <input
                type="radio"
                name="visibility"
                value="public"
                [ngModel]="visibility()"
                (ngModelChange)="visibility.set($event)" />
              <span>{{ 'quiz.visibility.public' | translate }}</span>
            </label>
          </div>
        </div>

        <div class="row colors">
          <div class="color-field">
            <label for="primaryColor">{{ 'settings.page.theme.custom.primaryLabel' | translate }}</label>
            <input
              id="primaryColor"
              type="color"
              [ngModel]="primaryColor()"
              (ngModelChange)="primaryColor.set($event)" />
            <span class="hex">{{ primaryColor() }}</span>
          </div>

          <div class="color-field">
            <label for="accentColor">{{ 'settings.page.theme.custom.accentLabel' | translate }}</label>
            <input
              id="accentColor"
              type="color"
              [ngModel]="accentColor()"
              (ngModelChange)="accentColor.set($event)" />
            <span class="hex">{{ accentColor() }}</span>
          </div>
        </div>

        <div class="row colors">
          <div class="color-field">
            <label for="backgroundLightColor">{{ 'settings.page.theme.custom.backgroundLightLabel' | translate }}</label>
            <input
              id="backgroundLightColor"
              type="color"
              [ngModel]="backgroundLightColor()"
              (ngModelChange)="backgroundLightColor.set($event)" />
            <span class="hex">{{ backgroundLightColor() }}</span>
          </div>

          <div class="color-field">
            <label for="backgroundDarkColor">{{ 'settings.page.theme.custom.backgroundDarkLabel' | translate }}</label>
            <input
              id="backgroundDarkColor"
              type="color"
              [ngModel]="backgroundDarkColor()"
              (ngModelChange)="backgroundDarkColor.set($event)" />
            <span class="hex">{{ backgroundDarkColor() }}</span>
          </div>
        </div>
      </div>

      <div class="preview-card">
        <div class="preview-header">
          <strong>{{ 'settings.page.theme.custom.preview' | translate }}</strong>
        </div>
        <div class="preview-gradient" [style.background]="previewGradient()"></div>
      </div>
    </div>
  }

  @if (unsavedChanges()) {
    <div class="unsaved-indicator">
      <span class="dot"></span>
      {{ 'common.unsavedChanges' | translate }}
    </div>
  }
</div>
