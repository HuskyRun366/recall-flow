<div class="filter-panel" [class.expanded]="isExpanded()">
  <div class="filter-header">
    <button class="filter-toggle" (click)="toggleExpanded()">
      <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="18" height="18">
        <polygon points="22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3"/>
      </svg>
      <span>{{ 'discover.filters.title' | translate }}</span>
      @if (activeFilterCount() > 0) {
        <span class="filter-count">{{ activeFilterCount() }}</span>
      }
      <svg class="chevron" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" width="16" height="16">
        <polyline points="6 9 12 15 18 9"/>
      </svg>
    </button>

    @if (hasActiveFilters()) {
      <button class="clear-btn" (click)="clearFilters()">
        {{ 'discover.filters.clearAll' | translate }}
      </button>
    }
  </div>

  <div class="filter-content">
    <!-- Content Type -->
    <div class="filter-group">
      <label class="filter-label">{{ 'discover.contentType' | translate }}</label>
      <div class="filter-chips">
        @for (type of contentTypes; track type.value) {
          <button
            class="chip"
            [class.active]="contentType() === type.value"
            (click)="contentType.set(type.value); onFilterChange()"
          >
            {{ type.label | translate }}
          </button>
        }
      </div>
    </div>

    <!-- Category -->
    <div class="filter-group">
      <label class="filter-label">{{ 'discover.category' | translate }}</label>
      <select
        [ngModel]="category()"
        (ngModelChange)="category.set($event); onFilterChange()"
        class="filter-select"
      >
        <option [ngValue]="null">{{ 'discover.categoryNone' | translate }}</option>
        @for (cat of categories; track cat) {
          <option [ngValue]="cat">{{ 'discover.categories.' + cat | translate }}</option>
        }
      </select>
    </div>

    <!-- Difficulty -->
    <div class="filter-group">
      <label class="filter-label">{{ 'discover.difficulty' | translate }}</label>
      <div class="filter-chips">
        <button
          class="chip"
          [class.active]="difficulty() === null"
          (click)="difficulty.set(null); onFilterChange()"
        >
          {{ 'discover.difficultyNone' | translate }}
        </button>
        @for (diff of difficulties; track diff) {
          <button
            class="chip"
            [class.active]="difficulty() === diff"
            [class]="'difficulty-' + diff"
            (click)="difficulty.set(diff); onFilterChange()"
          >
            {{ 'discover.difficulties.' + diff | translate }}
          </button>
        }
      </div>
    </div>

    <!-- Language -->
    <div class="filter-group">
      <label class="filter-label">{{ 'discover.language' | translate }}</label>
      <div class="filter-chips">
        <button
          class="chip"
          [class.active]="language() === null"
          (click)="language.set(null); onFilterChange()"
        >
          {{ 'discover.languageNone' | translate }}
        </button>
        @for (lang of languages; track lang.code) {
          <button
            class="chip"
            [class.active]="language() === lang.code"
            (click)="language.set(lang.code); onFilterChange()"
          >
            {{ lang.label }}
          </button>
        }
      </div>
    </div>
  </div>
</div>
