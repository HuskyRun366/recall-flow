<div class="star-rating" [class]="'size-' + size()" [class.editable]="editable()">
  <div class="stars" (mouseleave)="onStarLeave()">
    @for (star of stars(); track star.value) {
      <button
        type="button"
        class="star"
        [class.filled]="star.filled"
        [class.half]="star.half"
        [class.empty]="star.empty"
        [disabled]="!editable()"
        (click)="onStarClick(star.value)"
        (mouseenter)="onStarHover(star.value)"
        [attr.aria-label]="star.value + ' stars'"
      >
        <svg viewBox="0 0 24 24" fill="currentColor">
          @if (star.filled) {
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
          } @else if (star.half) {
            <defs>
              <linearGradient id="halfGradient">
                <stop offset="50%" stop-color="currentColor"/>
                <stop offset="50%" stop-color="transparent"/>
              </linearGradient>
            </defs>
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="url(#halfGradient)" stroke="currentColor" stroke-width="1"/>
          } @else {
            <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z" fill="none" stroke="currentColor" stroke-width="1.5"/>
          }
        </svg>
      </button>
    }
  </div>

  @if (showCount() && count() !== null) {
    <span class="rating-info">
      <span class="rating-value">{{ displayRating() }}</span>
      <span class="rating-count">({{ count() }})</span>
    </span>
  } @else if (!editable() && rating() > 0) {
    <span class="rating-info">
      <span class="rating-value">{{ displayRating() }}</span>
    </span>
  }
</div>
